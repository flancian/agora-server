<!-- __EXECTIME__ and __NOW__ get replaced in after_request. -->
<!-- contains potentially useful 'development' easter egg :) -->

<div class="footer-wrapper">
<div id='footer'>

    <!-- Served by the <a href="{{config['URL_BASE']}}">{{config['AGORA_NAME']}}</a> at <strong>__NOW__</strong> in <strong><a style="all: unset;"href="http://localhost:5017/{{node.qstr}}">__EXECTIME__s</a></strong>.
    -->
    {% if 'development' in config.AGORA_NAME.lower() or 'alpha' in config.AGORA_NAME.lower() %}<a class="all-unset" href="{{config.PROD_URL_BASE}}/{{node.qstr}}">🍮</a>{% else %}<a class="all-unset" href="{{config.DEV_URL_BASE}}/{{node.qstr}}">🍮</a>{% endif %}
    Served by the 
    🏛️ <a href="{{config['URL_BASE']}}">{{config['AGORA_NAME']}}</a>
    at <strong>__NOW__</strong>
    {% if 'Flan' in config['AGORA_NAME'] %} for the benefit of all beings{% else %} {% endif %}
    &nbsp;
    <button id="mini-cli-root" onclick="location.href='{{config['ROOT']}}'" title="Go to the root of the Agora.">🌱 See root</button>
    <!-- <button id="mini-cli-source" onclick="location.href='{{config['SOURCE']}}'" title="Go to the source code of this Agora.">👨‍💻 Get Source</button> -->
    <button id="mini-cli-retry" value="retry" title="Retries/reloads, might fix transient errors, might show content from a different Agora eventually.">
              🔄 retry
           </button>
    {% if config.ENABLE_FLUSH_CACHE_BUTTON %}
    <button id="mini-cli-flush-cache" onclick="flushCache(this)" title="Flushes the in-memory caches for this Agora process. Useful for development.">
        🚽 Flush Cache
    </button>
    <script>
        function flushCache(button) {
            const originalText = button.innerHTML;
            button.innerHTML = '🚽 Flushing...';
            button.disabled = true;

            fetch('/cachez', {
                method: 'POST',
            })
            .then(response => {
                if (response.ok) {
                    button.innerHTML = '🚽 Flushed!';
                } else {
                    button.innerHTML = '🚽 Error!';
                }
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000); // Reset after 2 seconds
            })
            .catch(error => {
                console.error('Error flushing cache:', error);
                button.innerHTML = '🚽 Error!';
                setTimeout(() => {
                    button.innerHTML = originalText;
                    button.disabled = false;
                }, 2000);
            });
        }
    </script>
    {% endif %}
</div>
</div>




